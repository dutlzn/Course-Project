---
typora-root-url: /images
---



# 通用代码生成器

# 原理介绍

FreeMarker时一款模板引擎，通过模板生成文件，包括html页面，excel等，

利用fm来制作前后端代码生成器，提高开发效率

 目标就是2分钟之内完成单表的增删改查 包含前后端代码

## 集成freemarker模板引擎

freemarker 和 thymeleaf 两种模板引擎， 前者推出的时间早，后者是spring官方推荐的

两者的代码风格不同：

freemarker：逻辑主要写再自定义标签中,

thymeleaf:逻辑主要卸载标签属性中，web开发时可读性好一点，随着版本不断更新，

两者性能正常使用没什么区别，不用纠结

根目录下pom.xml

```
<!--          freemarker-->
         <dependency>
            <groupId>org.freemarker</groupId>
            <artifactId>freemarker</artifactId>
            <version>2.3.30</version>
         </dependency>
```





新增generator子模块，代码生成器专用，并添加freemarker jar 依赖

```
    <dependencies>
<!--        freemarker模板引擎-->
        <dependency>
            <groupId>org.freemarker</groupId>
            <artifactId>freemarker</artifactId>
        </dependency>
    </dependencies>
```



子模块里面

新建包

com.lzn.generator.test

添加模板文件test.ftl和启动文件testutil.java

.ftl是约定的模板后缀名，也可以改成其他名字



test.utl

```java
package com.lzn.generator.test;
public class Test {
    /**
    * ID
    */
    private String id;
}
```

test.java 是生成出来的类

TestUtil.java

```java
import freemarker.template.Configuration;
import freemarker.template.DefaultObjectWrapper;
import freemarker.template.Template;
import freemarker.template.TemplateException;

import java.io.BufferedWriter;
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;

public class TestUtil {

    static String ftlPath = "generator\\src\\main\\java\\com\\course\\generator\\test\\";
    static String toPath = "generator\\src\\main\\java\\com\\course\\generator\\test\\";

    public static void main(String[] args) throws IOException, TemplateException {
        Configuration cfg = new Configuration(Configuration.VERSION_2_3_29);
        cfg.setDirectoryForTemplateLoading(new File(ftlPath));
        cfg.setObjectWrapper(new DefaultObjectWrapper(Configuration.VERSION_2_3_29));
        Template temp = cfg.getTemplate("test.ftl");

        FileWriter fw = new FileWriter(toPath + "Test.java");
        BufferedWriter bw = new BufferedWriter(fw);
        temp.process(null, bw);
        bw.flush();
        fw.close();
    }
```

Test.java文件可以不用删除，freemarker生成文件会自动覆盖。

# controller层和service层代码生成

## 小节表持久层代码生成

数据库

```sql
-- 小节
drop table if exists `section`;
create table `section` (
  `id` char(8) not null default '' comment 'id',
  `title` varchar(50) not null comment '标题',
  `course_id` char(8) comment '课程|course.id',
  `chapter_id` char(8) comment '大章|chapter.id',
  `video` varchar(200) comment '视频',
  `time` int comment '时长|单位秒',
  `charge` char(1) comment '收费|C 收费；F 免费',
  `sort` int comment '顺序',
  `created_at` datetime(3) comment '创建时间',
  `updated_at` datetime(3) comment '修改时间',
  primary key (`id`)
) engine=innodb default charset=utf8mb4 comment='小节';

insert into `section` (id, title, course_id, chapter_id, video, time, charge, sort, created_at, updated_at)
values ('00000001', '测试小节01', '00000001', '00000000', '', 500, 'f', 1, now(), now());

```



生成持久层代码

修改generatorConfig.xml


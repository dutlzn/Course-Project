---
typora-root-url: /images
---

# 核心业务功能开发

# 课程大章小节关联

## 课程管理页面美化

public static image demo-course.jpg



目标代码

```html
	<div class="thumbnail search-thumbnail">
																<img class="media-object" data-src="holder.js/100px200?theme=gray" />
																<div class="caption">
																	<div class="clearfix">
																		<span class="pull-right label label-grey info-label">Tokyo</span>
																	</div>

																	<h3 class="search-title">
																		<a href="#" class="blue">Thumbnail label</a>
																	</h3>
																	<p>Cras justo odio, dapibus ac facilisis in, egestas eget quam ...</p>
																</div>
															</div>
```





course.vue

注释掉table

加入

```vue

    <div class="row">
      <div v-for="course in courses" class="col-md-4">
        <div class="thumbnail search-thumbnail">
          <img
            v-show="!course.image"
            class="media-object"
            src="/static/image/demo-course.jpg"
          />
          <img
            v-show="course.image"
            class="media-object"
            v-bind:src="course.image"
          />

          <div class="caption">
            <div class="clearfix">
              <span class="pull-right label label-grey info-label">{{
                COURSE_LEVEL | optionKV(course.level)
              }}</span>
              <span class="pull-right label label-grey info-label">{{
                COURSE_CHARGE | optionKV(course.charge)
              }}</span>
              <span class="pull-right label label-grey info-label"
                >{{ COURSE_STATUS | optionKV(course.status) }}}</span
              >
            </div>

            <h3 class="search-title">
              <a href="#" class="blue">{{ course.name }} </a>
            </h3>
            <p>
              {{ course.summary }}
            </p>
            <p>
              <button v-on:click="edit(course)" class="btn btn-xs btn-info">
                <i class="ace-icon fa fa-pencil bigger-120"></i>
              </button>
              <button v-on:click="del(course.id)" class="btn btn-xs btn-danger">
                <i class="ace-icon fa fa-trash-o bigger-120"></i>
              </button>
            </p>
          </div>
        </div>
      </div>
    </div>
```





scoped : style下的样式只应用于当前组件，防止互相污染

```js

<style scoped>
.caption h3 {
  font-size: 30px;
}
</style>
```



```js

    <div class="row">
      <div v-for="course in courses" class="col-md-4">
        <div class="thumbnail search-thumbnail">
          <img
            v-show="!course.image"
            class="media-object"
            src="/static/image/demo-course.jpg"
          />
          <img
            v-show="course.image"
            class="media-object"
            v-bind:src="course.image"
          />

          <div class="caption">
            <div class="clearfix">
              <span class="pull-right label label-primary info-label">{{
                COURSE_LEVEL | optionKV(course.level)
              }}</span>
              <span class="pull-right label label-primary info-label">{{
                COURSE_CHARGE | optionKV(course.charge)
              }}</span>
              <span class="pull-right label label-primary info-label">{{
                COURSE_STATUS | optionKV(course.status)
              }}</span>
            </div>

            <h3 class="search-title">
              <a href="#" class="blue">{{ course.name }} </a>
            </h3>

            <p>
              <span class="blue bolder bigger-150"
                >{{ course.price }}&nbsp;<i class="fa fa-rmb"></i
              ></span>
            </p>

            <p>
              {{ course.summary }}
            </p>

            <p>
              <span class="badge badge-info"> {{ course.id }} </span>
              <span class="badge badge-info">排序:{{ course.sort }} </span>
              <span class="badge badge-info">时长:{{ course.time }} </span>
            </p>
            <p>
              <button
                v-on:click="edit(course)"
                class="btn btn-white btn-xs btn-info btn-round"
              >
                <!-- <i class="ace-icon fa fa-pencil bigger-120"></i> -->
                编辑
              </button>
              <button
                v-on:click="del(course.id)"
                class="btn btn-white btn-xs btn-warning btn-round"
              >
                <!-- <i class="ace-icon fa fa-trash-o bigger-120"></i> -->
                删除
              </button>
            </p>
          </div>
        </div>
      </div>
    </div>
```



但是存在问题

没法自适应



## 课程管理与大章管理互相跳转

完成功能：

在课程列表中增加 大章 按钮，点击会跳转到大章页面，并且筛选出当前课程下所有的大章，大章页面增加显示课程名称，并有可以返回课程管理页面



public static js

session-storage.js

```js
SESSION_KEY_COURSE = "SESSION_KEY_COURSE"; // 课程管理页面点击章管理时，保存课程信息
SESSION_KEY_CHAPTER = "SESSION_KEY_CHAPTER"; // 章管理页面点击节管理时，保存章信息
SESSION_KEY_LOGIN_USER = "SESSION_KEY_LOGIN_USER"; // 登录信息

SessionStorage = {
    get: function (key) {
        let v = sessionStorage.getItem(key);
        if (v && typeof(v) !== "undefined" && v !== "undefined") {
            return JSON.parse(v);
        }
    },
    set: function (key, data) {
        sessionStorage.setItem(key, JSON.stringify(data));
    },
    remove: function (key) {
        sessionStorage.removeItem(key);
    },
    clearAll: function () {
        sessionStorage.clear();
    }
};
```





local-storage.js

```js
LOCAL_KEY_REMEMBER_USER = "LOCAL_KEY_REMEMBER_USER"; // 记住我

LocalStorage = {
    get: function (key) {
        let v = localStorage.getItem(key);
        if (v && typeof(v) !== "undefined" && v !== "undefined") {
            return JSON.parse(v);
        }
    },
    set: function (key, data) {
        localStorage.setItem(key, JSON.stringify(data));
    },
    remove: function (key) {
        localStorage.removeItem(key);
    },
    clearAll: function () {
        localStorage.clear();
    }
};

```





说明：

sessionStorage是会话缓存，浏览器窗口关闭了，就没有了 ，

localStorage是本地缓存，浏览器关闭后，下次再打开还能读到

自带的只能操作字符串，但是我们经常要放对象数据，所以封装一下



course.vue 



```vue
     <button v-on:click="toChapter(course)" class="btn btn-white btn-default btn-round">
        <i class="ace-icon fa fa-edit"></i>
        大章
      </button>
```



组件（页面）间传输数据可以用h5原生的localStorage sessionStorage

也可以用js 全局变量，

也可以用vuex store，但是后两者在页面刷新时会丢失数据，所以推荐用h5原生的





index.html先导入

```
   <!--  h5缓存  -->
    <script src="<%= BASE_URL %>static/js/session-storage.js"></script>
    <script src="<%= BASE_URL %>static/js/local-storage.js"></script>
```





chapter.vue

```vue
  data: function () {
    return {
      // 映射表单数据
      chapter: {},
      chapters: [],
      course: {},
    };
  },

  // 页面初始化加载方法
  mounted: function () {
    // this.$parent.activeSidebar('business-chapter-sidebar');
    let _this = this;
    _this.$refs.pagination.size = 5;
    let course = SessionStorage.get("course") || {} ;
    if ( Tool.isEmpty(course) ) {
      _this.$router.push("/welcome");
    }
    _this.course = course.name;
    _this.list(1);
  },
```





简单的跳转可以用router-link 类似a标签，如果是有其他的操作，可以写个click方法，比如前面完成的，从课程跳转到大章，需要先缓存课程信息，所以写click方法

```vue
 <router-link to = "/business/course" class="btn btn-white btn-default btn-round">
        <i class="ace-icon fa fa-arrow-left"></i>
        返回课程
      </router-link>
```

